{% extends "base.html" %}
{% load static %}

{% block title %}{{ trip.title }} — Nile Dreams{% endblock %}

{% block content %}
<section class="relative h-[60vh] overflow-hidden">
  <img src="{% static trip.image %}" alt="{{ trip.title }}" class="absolute inset-0 h-full w-full object-cover" />
  <div class="absolute inset-0 bg-black/40"></div>
  <div class="relative z-10 flex h-full items-end">
    <div class="mx-auto w-full max-w-7xl px-4 pb-12">
      <a href="{% url 'web:trips' %}" class="mb-4 inline-flex items-center gap-2 text-sm font-medium text-white transition-colors hover:text-white/80">
        <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" d="m15 19-7-7 7-7" />
        </svg>
        Back to all trips
      </a>
      <span class="mb-4 inline-flex items-center rounded-full bg-primary px-3 py-1 text-xs font-semibold uppercase tracking-wide text-primary-foreground">{{ trip.category }}</span>
      <h1 class="font-serif text-4xl text-white md:text-5xl">{{ trip.title }}</h1>
      <p class="mt-4 max-w-3xl text-lg text-white/90">{{ trip.description }}</p>
    </div>
  </div>
</section>

<section class="bg-background px-4 py-16 sm:px-6 lg:px-8">
  <div class="mx-auto max-w-7xl">
    <div class="grid gap-12 lg:grid-cols-3">
      <article class="space-y-12 lg:col-span-2">
        <div class="grid grid-cols-2 gap-6 md:grid-cols-4">
          <div class="rounded-lg bg-muted p-4 text-center">
            <div class="mb-2 flex justify-center text-primary">
              <svg class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-6v6l4 2" />
              </svg>
            </div>
            <p class="text-sm text-muted-foreground">Duration</p>
            <p class="font-semibold text-foreground">{{ trip.duration }}</p>
          </div>
          <div class="rounded-lg bg-muted p-4 text-center">
            <div class="mb-2 flex justify-center text-primary">
              <svg class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="M16 17v-1a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v1" />
                <circle cx="8" cy="7" r="3" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M22 17v-1a4 4 0 0 0-3-3.87" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a3 3 0 0 1-2 2.82" />
              </svg>
            </div>
            <p class="text-sm text-muted-foreground">Group Size</p>
            <p class="font-semibold text-foreground">{{ trip.group_size }}</p>
          </div>
          <div class="rounded-lg bg-muted p-4 text-center">
            <div class="mb-2 flex justify-center text-primary">
              <svg class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="M5.25 5.25 6 3h12l.75 2.25M5.25 5.25h13.5M5.25 5.25 4.5 8.25m15-3-1.5 6m0 0H6.75m11.25 0 1.125 4.5A2.25 2.25 0 0 1 16.95 18H7.05a2.25 2.25 0 0 1-2.175-1.5L6 8.25m0 0L4.875 12.75M9 21h6" />
              </svg>
            </div>
            <p class="text-sm text-muted-foreground">Location</p>
            <p class="font-semibold text-foreground">{{ trip.location }}</p>
          </div>
          <div class="rounded-lg bg-muted p-4 text-center">
            <div class="mb-2 flex justify-center text-primary">
              <svg class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 5.25c0-.621.504-1.125 1.125-1.125h15.75c.621 0 1.125.504 1.125 1.125v13.5c0 .621-.504 1.125-1.125 1.125H4.125A1.125 1.125 0 0 1 3 18.75V5.25ZM3 9h18" />
              </svg>
            </div>
            <p class="text-sm text-muted-foreground">Guest Rating</p>
            <p class="font-semibold text-foreground">{{ trip.rating }}</p>
          </div>
        </div>

        <section>
          <h2 class="font-serif text-3xl text-foreground">Tour Highlights</h2>
          <div class="mt-6 grid gap-4 md:grid-cols-2">
            {% for highlight in trip.highlights %}
            <div class="flex items-start gap-3">
              <svg class="mt-1 h-5 w-5 text-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
              </svg>
              <p class="text-muted-foreground">{{ highlight }}</p>
            </div>
            {% endfor %}
          </div>
        </section>

        <section>
          <h2 class="font-serif text-3xl text-foreground">Itinerary</h2>
          <div class="mt-6 space-y-4">
            {% for item in trip.itinerary %}
            <div class="flex gap-4 rounded-lg bg-muted p-4">
              <div class="flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full bg-primary/10 text-primary font-semibold">{{ forloop.counter }}</div>
              <div>
                <p class="font-semibold text-foreground">{{ item.time }}</p>
                <p class="text-muted-foreground">{{ item.activity }}</p>
              </div>
            </div>
            {% endfor %}
          </div>
        </section>

        <section class="grid gap-8 md:grid-cols-2">
          <div>
            <h3 class="font-serif text-xl text-foreground">What's Included</h3>
            <ul class="mt-4 space-y-3 text-muted-foreground">
              {% for item in trip.included %}
              <li class="flex items-start gap-2">
                <svg class="mt-1 h-4 w-4 text-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" d="m5 13 4 4L19 7" />
                </svg>
                <span>{{ item }}</span>
              </li>
              {% endfor %}
            </ul>
          </div>
          <div>
            <h3 class="font-serif text-xl text-foreground">Not Included</h3>
            <ul class="mt-4 space-y-3 text-muted-foreground">
              {% for item in trip.not_included %}
              <li class="flex items-start gap-2">
                <span class="mt-1 inline-flex h-5 w-5 items-center justify-center rounded-full bg-muted text-xs font-semibold text-muted-foreground">×</span>
                <span>{{ item }}</span>
              </li>
              {% endfor %}
            </ul>
          </div>
        </section>
      </article>

      <aside class="lg:col-span-1">
        <div class="sticky top-24 space-y-6 rounded-lg bg-muted p-6">
          <div>
            <p class="text-3xl font-serif text-primary">{{ trip.price }}<span class="text-sm text-muted-foreground font-sans"> / person</span></p>
            <p class="mt-2 text-sm text-muted-foreground">{{ trip.booking_note }}</p>
          </div>

          {% if messages %}
          <div class="space-y-3">
            {% for message in messages %}
            <div class="rounded-md border px-4 py-3 text-sm {% if message.tags == 'success' %}border-green-300 bg-green-50 text-green-700{% elif message.tags == 'error' %}border-red-300 bg-red-50 text-red-700{% else %}border-border bg-background text-foreground{% endif %}">
              {{ message }}
            </div>
            {% endfor %}
          </div>
          {% endif %}

          <form action="" method="post" class="space-y-4" id="booking-form" data-module="booking-form">
            {% csrf_token %}
            {% if form.non_field_errors %}
            <div class="rounded-md border border-red-300 bg-red-50 px-4 py-3 text-sm text-red-700">
              {{ form.non_field_errors|striptags }}
            </div>
            {% endif %}
            {% for field in form %}
            <div>
              <label for="{{ field.id_for_label }}" class="mb-2 block text-sm font-medium text-foreground">{{ field.label }}</label>
              {{ field }}
              {% if field.errors %}
              <p class="mt-2 text-sm text-red-600">{{ field.errors|striptags }}</p>
              {% endif %}
            </div>
            {% endfor %}
            <button type="submit" class="inline-flex w-full items-center justify-center rounded-md bg-primary px-5 py-3 text-sm font-medium text-primary-foreground transition-colors hover:bg-primary/90">Request Itinerary</button>
          </form>

          <div class="rounded-md bg-background p-4 text-sm text-muted-foreground">
            <p class="font-semibold text-foreground">Need help planning?</p>
            <p class="mt-1">Speak with our travel specialists to tailor this experience to your schedule.</p>
            <p class="mt-4">
              <a href="mailto:info@niledreams.com" class="text-primary underline hover:text-accent">info@niledreams.com</a>
            </p>
          </div>
        </div>

        {% if other_trips %}
        <div class="mt-12 space-y-4">
          <h3 class="font-serif text-xl text-foreground">Other Experiences</h3>
          <ul class="space-y-4">
            {% for other in other_trips %}
            <li class="rounded-lg border border-border p-4 transition-colors hover:border-primary/60 hover:shadow-sm">
              <a href="{% url 'web:trip-detail' other.slug %}" class="block">
                <p class="text-sm uppercase tracking-wide text-muted-foreground">{{ other.category }}</p>
                <p class="mt-1 font-semibold text-foreground">{{ other.title }}</p>
                <p class="mt-2 text-sm text-muted-foreground">{{ other.description }}</p>
              </a>
            </li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}
      </aside>
    </div>
  </div>
</section>
{% endblock %}
